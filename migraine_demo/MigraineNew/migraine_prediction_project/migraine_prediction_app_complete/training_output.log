2025-04-19 17:21:23.569914: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-19 17:21:23.576666: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-19 17:21:23.594327: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745097683.622954   36703 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745097683.631661   36703 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1745097683.654847   36703 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745097683.654904   36703 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745097683.654914   36703 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745097683.654919   36703 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-04-19 17:21:23.661713: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
=== Starting Unified Migraine Prediction Solution ===
Loading data from output/data
Train set: 2520 samples, positive ratio: 0.50
Validation set: 200 samples, positive ratio: 0.10
Test set: 400 samples, positive ratio: 0.10

=== Preprocessing Data ===
Preprocessed sleep features shape: (2520, 42)
Preprocessed weather features shape: (2520, 4)
Preprocessed stress/diet features shape: (2520, 42)
Preprocessed physiological features shape: (2520, 5)

=== Applying Class Balancing ===

Applying BorderlineSMOTE...
Error with BorderlineSMOTE: The specified ratio required to remove samples from the minority class while trying to generate new samples. Please increase the ratio., falling back to regular SMOTE
Traceback (most recent call last):
  File "/home/ubuntu/migraine_demo/MigraineNew/migraine_prediction_project/migraine_prediction_app_complete/simplified_unified_solution.py", line 236, in apply_class_balancing
    X_combined_balanced, y_balanced = smote.fit_resample(X_combined, y)
  File "/usr/local/lib/python3.10/dist-packages/imblearn/base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
  File "/usr/local/lib/python3.10/dist-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/imblearn/base.py", line 101, in fit_resample
    self.sampling_strategy_ = check_sampling_strategy(
  File "/usr/local/lib/python3.10/dist-packages/imblearn/utils/_validation.py", line 571, in check_sampling_strategy
    _sampling_strategy_float(sampling_strategy, y, sampling_type).items()
  File "/usr/local/lib/python3.10/dist-packages/imblearn/utils/_validation.py", line 410, in _sampling_strategy_float
    raise ValueError(
ValueError: The specified ratio required to remove samples from the minority class while trying to generate new samples. Please increase the ratio.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ubuntu/migraine_demo/MigraineNew/migraine_prediction_project/migraine_prediction_app_complete/simplified_unified_solution.py", line 1102, in <module>
    main()
  File "/home/ubuntu/migraine_demo/MigraineNew/migraine_prediction_project/migraine_prediction_app_complete/simplified_unified_solution.py", line 1060, in main
    balanced_train_data = apply_class_balancing(preprocessed_train_data)
  File "/home/ubuntu/migraine_demo/MigraineNew/migraine_prediction_project/migraine_prediction_app_complete/simplified_unified_solution.py", line 240, in apply_class_balancing
    X_combined_balanced, y_balanced = smote.fit_resample(X_combined, y)
  File "/usr/local/lib/python3.10/dist-packages/imblearn/base.py", line 202, in fit_resample
    return super().fit_resample(X, y, **params)
  File "/usr/local/lib/python3.10/dist-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/imblearn/base.py", line 101, in fit_resample
    self.sampling_strategy_ = check_sampling_strategy(
  File "/usr/local/lib/python3.10/dist-packages/imblearn/utils/_validation.py", line 571, in check_sampling_strategy
    _sampling_strategy_float(sampling_strategy, y, sampling_type).items()
  File "/usr/local/lib/python3.10/dist-packages/imblearn/utils/_validation.py", line 410, in _sampling_strategy_float
    raise ValueError(
ValueError: The specified ratio required to remove samples from the minority class while trying to generate new samples. Please increase the ratio.
